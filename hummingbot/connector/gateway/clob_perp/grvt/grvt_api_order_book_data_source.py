import aiohttp import asyncio import json from typing import Any, Dict, List, Optional from hummingbot.core.data_type.order_book import OrderBook from hummingbot.core.data_type.order_book_message import OrderBookMessage from hummingbot.connector.gateway.clob_perp.grvt import grvt_constants as constants from hummingbot.connector.gateway.clob_perp.grvt import grvt_utils as utils  class GrvtAPIOrderBookDataSource:     def __init__(self, trading_pairs: List[str]):         self._trading_pairs = trading_pairs         self._message_queue: asyncio.Queue = asyncio.Queue()      async def _listen_to_websocket(self):         """         Connects to GRVT WebSocket and subscribes to orderbook channels.         """         async with aiohttp.ClientSession() as session:             async with session.ws_connect(constants.GRVT_MAINNET_WS) as ws:                 for tp in self._trading_pairs:                     ex_tp = utils.convert_to_exchange_trading_pair(tp)                     subscribe_payload = {                         "method": "subscribe",                         "params": {"channel": constants.WS_ORDER_BOOK_DIFF_CHANNEL, "symbol": ex_tp},                         "id": 1                     }                     await ws.send_str(json.dumps(subscribe_payload))                  async for msg in ws:                     if msg.type == aiohttp.WSMsgType.TEXT:                         data = json.loads(msg.data)                         if "data" in data:                             # Push the raw message to the processing queue                             self._message_queue.put_nowait(data)                     elif msg.type in (aiohttp.WSMsgType.CLOSED, aiohttp.WSMsgType.ERROR):                         break
