import aiohttp import asyncio from typing import Any, Dict, List, Optional from hummingbot.core.data_type.order_book import OrderBook from hummingbot.connector.gateway.clob_perp.grvt import grvt_constants as constants from hummingbot.connector.gateway.clob_perp.grvt import grvt_utils as utils from hummingbot.connector.gateway.clob_perp.grvt.grvt_order_book import GrvtOrderBook  class GrvtAPIOrderBookDataSource:     def __init__(self, trading_pairs: List[str]):         self._trading_pairs = trading_pairs      async def get_last_traded_prices(self, trading_pairs: List[str]) -> Dict[str, float]:         results = {}         async with aiohttp.ClientSession() as client:             for tp in trading_pairs:                 ex_tp = utils.convert_to_exchange_trading_pair(tp)                 url = f"{constants.GRVT_MAINNET_REST}{constants.TICKER_PRICE_PATH_URL}?symbol={ex_tp}"                 async with client.get(url) as response:                     data = await response.json()                     # GRVT typically returns prices as strings or floats in 'lastPrice'                     results[tp] = float(data.get("lastPrice", 0.0))         return results      async def fetch_order_book(self, trading_pair: str) -> OrderBook:         ex_tp = utils.convert_to_exchange_trading_pair(trading_pair)         url = f"{constants.GRVT_MAINNET_REST}{constants.ORDER_BOOK_PATH_URL}?symbol={ex_tp}"                  async with aiohttp.ClientSession() as client:             async with client.get(url) as response:                 if response.status != 200:                     raise IOError(f"Error fetching Order Book for {trading_pair}. Status: {response.status}")                                  snapshot = await response.json()                 # Create the order book object from the snapshot data                 # Assuming 'timestamp' and 'data' are standard GRVT keys                 return GrvtOrderBook.snapshot_message_from_exchange(                     snapshot,                      snapshot.get("timestamp", 0)                 )
